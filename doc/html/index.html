<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Half step Rotary Encoder: 3 speed Rotary Encoder Half Step library for Arduino</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Half step Rotary Encoder
   &#160;<span id="projectnumber">1.0.1</span>
   </div>
   <div id="projectbrief">Three speed Half Step Rotary Encoder Library for Arduino</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">3 speed Rotary Encoder Half Step library for Arduino </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This is an optimized three speed Rotary Encoder library for Arduino which supports:</p>
<ul>
<li>Half step Rotary Encoder types.</li>
<li>Detect three rotation speeds.</li>
<li>Configurable rotation speed sensitivity.</li>
<li>Polling and interrupt based.</li>
<li>Single or multiple Rotary Encoders.</li>
<li>Optional Rotary button.</li>
<li>Pin state table in flash.</li>
</ul>
<h2>Half step / half step Rotary Encoders</h2>
<p>The difference between a half step or half step Rotary Encoder type is how the data signals of the two pins are generated. It depends on the mechanical construction of the notches and contacts inside the Rotary Encoder.</p>
<p>Please refer to the <a href="https://github.com/Erriez/ErriezRotaryEncoderFullStep">ErriezRotaryEncoderFullStep</a> library for full step Rotary Encoders. Experiment with the full step and half step libraries which works optimal for your Rotary Encoder.</p>
<h2>Hardware</h2>
<p>Connect the two rotary pins to the DIGITAL pins of an Arduino board.</p>
<p>A third rotary button pin is not used in the Rotary library, but can be used in the sketch.</p>
<p>Tested with Arduino IDE v1.8.5 on hardware:</p>
<ul>
<li>Arduino UNO</li>
<li>Arduino Nano</li>
<li>Arduino Micro</li>
<li>Arduino Pro or Pro Mini</li>
<li>Arduino Mega or Mega2560</li>
<li>Arduino Leonardo</li>
<li>WeMos D1 R2 &amp; mini (ESP8266)</li>
</ul>
<h3>Interrupts</h3>
<p>Both rotary pins must be connected to a DIGITAL pin with interrupt support, such as <code>INT0</code> or <code>INT1</code>. This is chip specific. Please refer to the documentation of your board or <a href="https://www.arduino.cc/reference/en/language/functions/external-interrupts/attachinterrupt/">attachInterrupt()</a>.</p>
<h3>Arduino UNO hardware</h3>
<p>The connection below can be used for polled and interrupts. An optional button pin can be connected to DIGITAL pin 4.</p>
<div class="image">
<img src="https://raw.githubusercontent.com/Erriez/ArduinoLibraryRotary/master/extras/FritzingRotary.png" alt="alt text" title="3-pin Rotary Encoder Arduino connection"/>
</div>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Rotary pin  </th><th class="markdownTableHeadCenter">Arduino UNO/NANO/Mega2560/Leonardo board   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">1  </td><td class="markdownTableBodyCenter">D2 (INT0)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">D3 (INT1)   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Button (optional)  </td><td class="markdownTableBodyCenter">D4   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">GND  </td><td class="markdownTableBodyCenter">GND   </td></tr>
</table>
<h3>Arduino WeMos D1 R2 &amp; mini (ESP8266) hardware</h3>
<p>Note that some ESP8266 pins mixes ESP8622 GPIO pins with Arduino digital pins. Connect a Rotary Encoder to the following pins which can be used with polled and interrupt examples:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Rotary pin  </th><th class="markdownTableHeadCenter">ESP8622 pin  </th><th class="markdownTableHeadCenter">Text on board<br />
WeMos D1 R2   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">1  </td><td class="markdownTableBodyCenter">GPIO13  </td><td class="markdownTableBodyCenter">D7 MOSI   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">2  </td><td class="markdownTableBodyCenter">GPIO12  </td><td class="markdownTableBodyCenter">D6 MISO   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">Button (optional)  </td><td class="markdownTableBodyCenter">GPIO14  </td><td class="markdownTableBodyCenter">D5 SCK   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter">LED (Not used)  </td><td class="markdownTableBodyCenter">GPIO2  </td><td class="markdownTableBodyCenter">D4   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">GND  </td><td class="markdownTableBodyCenter">GND  </td><td class="markdownTableBodyCenter">GND   </td></tr>
</table>
<p><b>Note:</b> An external pull-up resistor is required when a pin does not have an internal pull-up.</p>
<div class="fragment"><div class="line">{c++}</div><div class="line">// Connect the rotary pins to the WeMos D1 R2 board:</div><div class="line">#define ROTARY_PIN1         12</div><div class="line">#define ROTARY_PIN2         13</div><div class="line">#define ROTARY_BUTTON_PIN   14</div></div><!-- fragment --><h2>Examples</h2>
<p>The following examples are available:</p><ul>
<li>Rotary | Interrupt | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Interrupt/InterruptHalfStepBasic/InterruptHalfStepBasic.ino">InterruptHalfStepBasic</a></li>
<li>Rotary | Interrupt | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Interrupt/InterruptHalfStepButton/InterruptHalfStepButton.ino">InterruptHalfStepButton</a></li>
<li>Rotary | Interrupt | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Interrupt/InterruptHalfStepCounter/InterruptHalfStepCounter.ino">InterruptHalfStepCounter</a></li>
<li>Rotary | Polled | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Polled/PolledHalfStepBasic/PolledHalfStepBasic.ino">PolledHalfStepBasic</a></li>
<li>Rotary | Polled | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Polled/PolledHalfStepButton/PolledHalfStepButton.ino">PolledHalfStepButton</a></li>
<li>Rotary | Polled | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Polled/PolledHalfStepCounter/PolledHalfStepCounter.ino">PolledHalfStepCounter</a></li>
<li>Rotary | Polled | <a href="https://github.com/Erriez/ArduinoLibraryRotary/blob/master/examples/Polled/PolledHalfStepMultiple/PolledHalfStepMultiple.ino">PolledHalfStepMultiple</a></li>
</ul>
<h2>Usage</h2>
<p><b>Read rotary with polling</b> </p><div class="fragment"><div class="line">{c++}</div><div class="line">#include &lt;RotaryHalfStep.h&gt;</div><div class="line"></div><div class="line">// Connect rotary pins to the DIGITAL pins of the Arduino board</div><div class="line">#define ROTARY_PIN1   2</div><div class="line">#define ROTARY_PIN2   3</div><div class="line"></div><div class="line">// Enable ONE of the three constructors below with different number of arguments:</div><div class="line"></div><div class="line">// Initialize half step rotary encoder, default pull-up enabled, default </div><div class="line">// sensitive=100</div><div class="line">RotaryHalfStep rotary(ROTARY_PIN1, ROTARY_PIN2);</div><div class="line"></div><div class="line">// Or initialize half step rotary encoder, pull-up disabled, default sensitive=100</div><div class="line">// RotaryHalfStep rotary(ROTARY_PIN1, ROTARY_PIN2, false);</div><div class="line"></div><div class="line">// Or initialize half step rotary encoder, pull-up enabled, sensitive 1..255</div><div class="line">// A higher value is more sensitive</div><div class="line">// RotaryHalfStep rotary(ROTARY_PIN1, ROTARY_PIN2, true, 150);</div><div class="line"></div><div class="line">void loop()</div><div class="line">{</div><div class="line">  int rotaryState = rotary.read();</div><div class="line"></div><div class="line">  // rotaryState = -3: Counter clockwise turn, multiple notches fast</div><div class="line">  // rotaryState = -2: Counter clockwise turn, multiple notches</div><div class="line">  // rotaryState = -1: Counter clockwise turn, single notch</div><div class="line">  // rotaryState = 0:  No change</div><div class="line">  // rotaryState = 1:  Clockwise turn, single notch</div><div class="line">  // rotaryState = 2:  Clockwise turn, multiple notches</div><div class="line">  // rotaryState = 3:  Clockwise turn, multiple notches fast</div><div class="line">}</div></div><!-- fragment --><p><b>Read rotary with interrupts</b></p>
<div class="fragment"><div class="line">{c++}</div><div class="line">#include &lt;RotaryHalfStep.h&gt;</div><div class="line"></div><div class="line">// Connect rotary pins to Arduino DIGITAL pins with interrupt support:</div><div class="line">//</div><div class="line">// +-----------------------------------+--------------------------+</div><div class="line">// |              Board                |  DIGITAL interrupt pins  |</div><div class="line">// +-----------------------------------+--------------------------+</div><div class="line">// | Uno, Nano, Mini, other 328-based  |  2, 3                    |</div><div class="line">// | Mega, Mega2560, MegaADK           |  2, 3, 18, 19, 20, 21    |</div><div class="line">// | Micro, Leonardo, other 32u4-based |  0, 1, 2, 3, 7           |</div><div class="line">// +-----------------------------------+--------------------------+</div><div class="line">//</div><div class="line">#define ROTARY_PIN1   2</div><div class="line">#define ROTARY_PIN2   3</div><div class="line"></div><div class="line">// Enable ONE of the three constructors below with different number of arguments:</div><div class="line"></div><div class="line">// Initialize half step rotary encoder, default pull-up enabled, default </div><div class="line">// sensitive=100</div><div class="line">RotaryHalfStep rotary(ROTARY_PIN1, ROTARY_PIN2);</div><div class="line"></div><div class="line">// Or initialize half step rotary encoder, pull-up disabled, default sensitive=100</div><div class="line">// RotaryHalfStep rotary(ROTARY_PIN1, ROTARY_PIN2, false);</div><div class="line"></div><div class="line">// Or initialize half step rotary encoder, pull-up enabled, sensitive 1..255</div><div class="line">// A higher value is more sensitive</div><div class="line">// RotaryHalfStep rotary(ROTARY_PIN1, ROTARY_PIN2, true, 150);</div><div class="line"></div><div class="line">void setup()</div><div class="line">{</div><div class="line">  // Initialize pin change interrupt on both rotary encoder pins</div><div class="line">  attachInterrupt(digitalPinToInterrupt(ROTARY_PIN1), rotaryInterrupt, CHANGE);</div><div class="line">  attachInterrupt(digitalPinToInterrupt(ROTARY_PIN2), rotaryInterrupt, CHANGE);</div><div class="line">}</div><div class="line"></div><div class="line">void rotaryInterrupt()</div><div class="line">{</div><div class="line">  int rotaryState = rotary.read();</div><div class="line"></div><div class="line">  // rotaryState = -3: Counter clockwise turn, multiple notches fast</div><div class="line">  // rotaryState = -2: Counter clockwise turn, multiple notches</div><div class="line">  // rotaryState = -1: Counter clockwise turn, single notch</div><div class="line">  // rotaryState = 0:  No change</div><div class="line">  // rotaryState = 1:  Clockwise turn, single notch</div><div class="line">  // rotaryState = 2:  Clockwise turn, multiple notches</div><div class="line">  // rotaryState = 3:  Clockwise turn, multiple notches fast</div><div class="line">}</div></div><!-- fragment --><h2>Libary installation using Git</h2>
<p><code>Git</code> is the preferred way to keep this library up to date, because the Arduino Library manager does not update as long as this library is not added to the official Arduino Library database.</p>
<h3>Install Git client for Windows</h3>
<p>Install a <a href="https://git-scm.com/download/win">Git client for Windows</a>.</p>
<h3>Install Git client for Linux</h3>
<p>Open a command prompt and install a Git client for Linux, such as Debian Ubuntu:</p>
<div class="fragment"><div class="line">sudo apt-get install git</div></div><!-- fragment --><h3>Get Arduino libraries directory</h3>
<p>This library must be installed in the Arduino Sketchbook library subdirectory.</p>
<p>To retrieve the Arduino Sketchbook directory, open the Arduino IDE Preferences dialog box via: <code>File</code> | <code>Preferences</code> |<code>Settings tab</code> and copy the Sketchbook location.</p>
<p>For example on:</p>
<ul>
<li>Windows : <code>C:\Users\User\Documents\Arduino</code></li>
<li>Linux: <code>/home/user/Arduino</code></li>
</ul>
<h3>Clone this library</h3>
<p>Clone this library by opening a command prompt:</p>
<ul>
<li>Windows: (<code>Windows key + R</code>, Type <code>cmd</code> + <code>[ENTER]</code>)</li>
<li>Linux: Depends on your version.</li>
</ul>
<p>Then type:</p>
<div class="fragment"><div class="line"># Change directory to the sketchbook directory as configured in the Arduino IDE:</div><div class="line"># Windows:</div><div class="line">cd C:\Users\User\Documents\Arduino</div><div class="line"># Linux:</div><div class="line">cd ~/Arduino</div><div class="line"></div><div class="line"># Go to the libraries subdirectory</div><div class="line">cd libraries</div><div class="line"></div><div class="line"># Run the git clone library once:</div><div class="line">git clone https://github.com/Erriez/ErriezRotaryEncoderHalfStep.git</div></div><!-- fragment --><p><b>IMPORTANT:</b> Restart the Arduino IDE.</p>
<h3>Update this library</h3>
<p>Open a command prompt and type:</p>
<div class="fragment"><div class="line"># Change directory to the sketchbook directory as configured in the Arduino IDE:</div><div class="line"># Windows:</div><div class="line">cd C:\Users\User\Documents\Arduino</div><div class="line"># Linux:</div><div class="line">cd ~/Arduino</div><div class="line"></div><div class="line"># Go to the libraries subdirectory</div><div class="line">cd libraries</div><div class="line"></div><div class="line"># Update the library:</div><div class="line">git pull</div></div><!-- fragment --><p><b>IMPORTANT:</b> Restart the Arduino IDE.</p>
<h2>Libary installation with a ZIP</h2>
<p>This method is not preferred, because updates should be manually installed.</p>
<ol type="1">
<li>Download <a href="https://github.com/Erriez/ErriezRotaryEncoderHalfStep/archive/master.zip">the latest version here</a>.</li>
<li>Open the Arduino IDE.</li>
<li>Sketch | Include Library | Add .ZIP library...</li>
<li>Browse to the downloaded ZIP.</li>
<li>Restart the IDE. </li>
</ol>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
